{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>{{ titulo }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">{{ titulo }}</h5>
          <a href="{% url 'create' %}" class="btn btn-light btn-sm">+ Novo Contato</a>
        </div>

        <div class="card-body">
          {% if contacts %}
            <div class="row row-cols-1 row-cols-md-2 g-3">
              {% for contact in contacts %}
                <div class="col">
                  <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                      <h6 class="card-title mb-1">{{ contact.nome_completo }}</h6>
                      <p class="mb-1">
                        <strong>Telefone:</strong> {{ contact.telefone }}
                      </p>
                      <p class="mb-1">
                        <strong>Email:</strong> {{ contact.email }}
                      </p>
                      {% if contact.observacao %}
                        <p class="text-muted small mb-2">
                          <strong>Obs:</strong> {{ contact.observacao }}
                        </p>
                      {% endif %}

                      <div class="d-flex gap-2">
                        <a href="{% url 'detail' contact.pk %}" class="btn btn-info btn-sm text-white">Ver Detalhes</a>
                        <a href="{% url 'update' contact.pk %}" class="btn btn-warning btn-sm text-white">Editar Contato</a>

                        <!-- Botão que abre o modal -->
                        <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ contact.pk }}">Excluir</button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Modal de confirmação de exclusão -->
                <div class="modal fade" id="deleteModal{{ contact.pk }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ contact.pk }}" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content border-0 shadow">
                      <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title" id="deleteModalLabel{{ contact.pk }}">Confirmar exclusão</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
                      </div>
                      <div class="modal-body">
                        Tem certeza que deseja excluir <strong>{{ contact.nome_completo }}</strong>?
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <form method="POST" action="{% url 'delete' contact.pk %}">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-danger">Excluir</button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p class="text-muted mb-0">Nenhum contato cadastrado.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </body>
</html>
